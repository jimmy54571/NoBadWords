<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I计l萝t参</title>
    <script type="module">
        // 1?? 蹲J Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";

        // 2?? Firebase ]w]q Firebase Console 厂A罕M壮]w^
        const firebaseConfig = {
            apiKey: "AIzaSyC5xkI7FKP6fzbIg9LwAy7IXle6z4GnI-A",
            authDomain: "nobadword-87b1f.firebaseapp.com",
            projectId: "nobadword-87b1f",
            storageBucket: "nobadword-87b1f.firebasestorage.app",
            messagingSenderId: "604543524172",
            appId: "1:604543524172:web:06fdf372517480efd103e9"
        };

        // 3?? 飑lて Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 4?? 弄 Firestore い郝I计
        async function getPoints(user) {
            const docRef = doc(db, "points", user);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                return docSnap.data().points;
            } else {
                return 0; // w]
            }
        }

        // 5?? 蠓s Firestore I计
        async function deductPoint(user) {
            const docRef = doc(db, "points", user);
            let points = await getPoints(user);
            points = Math.max(0, points - 1);
            await setDoc(docRef, { points });
            alert(`${user} 逞lI计: ${points}`);
        }

        // 6?? I阑龆s砂酽姒┞I
        window.onload = async function () {
            document.getElementById("deductUser").onclick = () => deductPoint("user");
            document.getElementById("deductGF").onclick = () => deductPoint("girlfriend");
        };
    </script>
</head>
<body>
    <h1>I计l萝t参</h1>
    <button id="deductUser">Ι 1 I (User)</button>
    <button id="deductGF">Ι 1 I (Girlfriend)</button>
</body>
</html>
